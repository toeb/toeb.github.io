<!DOCTYPE html>
<html lang="en-us">
<head>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177198277-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-177198277-1');
    </script>


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="toeb&#39;s Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://toeb.github.io//images/carbon.png">
    <meta property="twitter:image" content="https://toeb.github.io//images/carbon.png" />
    

    
    <meta name="title" content="Renameable Namespaces using the Preprocessor" />
    <meta property="og:title" content="Renameable Namespaces using the Preprocessor" />
    <meta property="twitter:title" content="Renameable Namespaces using the Preprocessor" />
    

    
    <meta name="description" content="Renameable Namespaces using the Preprocessor">
    <meta property="og:description" content="Renameable Namespaces using the Preprocessor" />
    <meta property="twitter:description" content="Renameable Namespaces using the Preprocessor" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="thetoeb, toeb, blog, programming">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Renameable Namespaces using the Preprocessor-Toeb Blog</title>

    <link rel="canonical" href="/post/cpprenameablenamespaces/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">toeb&#39;s Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/c">c#</a>
                        </li>
                        
                        <li>
                            <a href="/categories/c&#43;&#43;">c&#43;&#43;</a>
                        </li>
                        
                        <li>
                            <a href="/categories/cmake">cmake</a>
                        </li>
                        
                        <li>
                            <a href="/categories/frontend">frontend</a>
                        </li>
                        
                        <li>
                            <a href="/categories/obsolete">obsolete</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/images/carbon.png')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/c&#43;&#43;" title="C&#43;&#43;">
                            C&#43;&#43;
                        </a>
                        
                        <a class="tag" href="/tags/obsolete" title="obsolete">
                            obsolete
                        </a>
                        
                    </div>
                    <h1>Renameable Namespaces using the Preprocessor</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                                toeb&#39;s Blog
                         
                        on 
                        Tuesday, October 14, 2014
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <h2 id="motivation">Motivation</h2>
<p>If you are starting to work on a library and do not know exactly how your namespaces are going end up these macro helper are for you. I have written helpers that simplify using namespaces and lets you build up your namespaces with preprocessor defines. This allows you to quickly rename your namespaces which in turn makes it alot more flexible. You can find the code on github. It is licensed under the MIT license.</p>
<p>The reason why I wanted to have renameable, dynamically generated namespaces was to allow me to statically link multiple versions of the same library and to achieve this I needed to to prepend a versioned namespace e.g. wrap all namespaces in another namespace. This could have been achieved by wrapping the all include files in another namespace but some edge cases did not allow me to do it this way. So I chose to make the namespaces “dynamic” (as in compile time dynamic) which I could control with a single preprocessor define.</p>
<h2 id="documentation">Documentation</h2>
<p>I provide you with the following macros:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">NS_BEGIN(...)
NS_END(...)
NS(...)
NS_USE(...)  
</code></pre></div><p>Instead of using namespace <code>X{ namespace Y{ ... } }</code> you write <code>NS_BEGIN(X,Y) ... NS_END(X,Y)</code> these macros expand to the namespace definitions and allow you to use preprocessor defines to name your namespaces.</p>
<p>A nice side effect is that your code is not indented anymore by your IDE which, in my opinion, makes the code harder to read as get more and more nested namespaces. Also you can explicitly see where your namespace ends which is very helpful in long files – I always seem to get mixed up with too many braces…</p>
<p>Of course your personal preferences may differ, but if you refactor without expensive tools defining your namespaces with these macros helps a lot as you only have to change it once. Furthermore you could easily add a build task that replaces these macros with the hard coded namespaces if you release your source code/ headers. (or leave them in, especially if you want your library users to be able to change the namespace as well).</p>
<p>Besides beginning and ending a namespace you can also use <code>NS(X,Y)</code> to reference a namespace as it is expanded to <code>X::Y</code>. Another shorthand which is useful is <code>NS_USE(X,Y)</code> which just creates a using namespace statement: <code>using namespace X::Y</code>.</p>
<p>Of course you can also mix the macro based namespace and hard coded namespace statement to your hearts content.</p>
<h2 id="example">Example</h2>
<p>Here is an example application that shows you how to use these macros:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cppnamespace/cppnamespace.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">/// defines which for naming the namespaces, allows the parameterized buildup of naming schemes 
</span><span style="color:#75715e"></span><span style="color:#75715e">#define BASE_NAMESPACE matlib  
</span><span style="color:#75715e">#define MATRIX_NAMESPACE BASE_NAMESPACE, matrix
</span><span style="color:#75715e">#define VECTOR_NAMESPACE BASE_NAMESPACE, vector
</span><span style="color:#75715e"></span>
NS_BEGIN(MATRIX_NAMESPACE)
<span style="color:#75715e">// equivalent to namespace matlib{ namespace matrix{ 
</span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Matrix</span>{
  <span style="color:#66d9ef">auto</span> <span style="color:#a6e22e">operator</span>()(<span style="color:#66d9ef">int</span> i, <span style="color:#66d9ef">int</span> j)<span style="color:#f92672">-&gt;</span><span style="color:#66d9ef">double</span>;
};
NS_END(MATRIX_NAMESPACE)
<span style="color:#75715e">//equivalent to }}
</span><span style="color:#75715e"></span>
NS_BEGIN(VECTOR_NAMESPACE)
<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Vector</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> NS(MATRIX_NAMESPACE)<span style="color:#f92672">::</span>Matrix{ <span style="color:#75715e">// a vector is a matrix the namespace is accessed via NS(...) macro
</span><span style="color:#75715e"></span> <span style="color:#66d9ef">auto</span> <span style="color:#a6e22e">operator</span>()(<span style="color:#66d9ef">int</span> i)<span style="color:#f92672">-&gt;</span><span style="color:#66d9ef">double</span>;
};

NS_END(VECTOR_NAMESPACE)

<span style="color:#66d9ef">int</span> main(){
<span style="color:#75715e">// using directive to access Vector
</span><span style="color:#75715e"></span> NS_USE(VECTOR_NAMESPACE);

 Vector v;
 <span style="color:#75715e">//global qualification for matrix - also works without using the preprocessor (but makes the code more brittle) 
</span><span style="color:#75715e"></span> <span style="color:#f92672">::</span>matlib<span style="color:#f92672">::</span>matrix<span style="color:#f92672">::</span>Matrix m;
}
</code></pre></div><h2 id="limitations">Limitations:</h2>
<p>Due to NS_REDUCE you can at most nest 100 namespaces (which is in itself absurd ;))
I am happy for any critiques in form of comments, stars, upvotes, likes, etc. Especially if you find this useful let me know! I am aware there is only a niche audience for this kind of preprocessor stuff – but I do like to share :)</p>


                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/alternativetypedefsyntax/" data-toggle="tooltip" data-placement="top" title="Alternative `typedef` Syntax">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/ctesttestadapter/" data-toggle="tooltip" data-placement="top" title="CTest and TextExplorer">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



<script src="https://utteranc.es/client.js"
repo="toeb/devblog"
issue-term="pathname"
label="comment"
theme="github-light"
crossorigin="anonymous"
async>
</script>





            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/c&#43;&#43;" title="c&#43;&#43;">
                            c&#43;&#43;
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/cmake" title="cmake">
                            cmake
                        </a>
                        
                        
                        
                        <a href="/tags/cmakepp" title="cmakepp">
                            cmakepp
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="toeb&#39;s Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:redacted@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/toeb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/tobias-becker-a64475a3/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a target="_blank" href="https://stackoverflow.com/users/1229468/toeb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    <li>
                        <a target="_blank" href="https://www.reddit.com/user/toebi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-reddit fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; toeb&#39;s Blog 2021
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
